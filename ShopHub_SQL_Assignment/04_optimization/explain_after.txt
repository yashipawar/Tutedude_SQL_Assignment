-- 04_optimization/explain_after.txt
-- Placeholder: After creating indexes, run the same EXPLAIN ANALYZE commands and paste outputs here.

-- After adding:
-- CREATE INDEX idx_order_items_order_id ON order_items(order_id);
-- CREATE INDEX idx_order_payments_order_id ON order_payments(order_id);
-- CREATE INDEX idx_order_items_product_id ON order_items(product_id);
-- CREATE INDEX idx_orders_customer_id ON orders(customer_id);

EXPLAIN ANALYZE SELECT o.order_id, SUM(oi.price), SUM(op.payment_value)
FROM orders o
JOIN order_items oi ON o.order_id = oi.order_id
JOIN order_payments op ON o.order_id = op.order_id
GROUP BY o.order_id;

EXPLAIN ANALYZE SELECT p.product_id, SUM(oi.price) AS rev
FROM products p
JOIN order_items oi ON p.product_id = oi.product_id
GROUP BY p.product_id;

EXPLAIN ANALYZE SELECT customer_id, COUNT(*) FROM orders GROUP BY customer_id;
